{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\HNC\\\\Desktop\\\\YT-image-upload\\\\front-end\\\\App.js\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState, useEffect } from 'react';\nimport Button from \"react-native-web/dist/exports/Button\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport * as ImagePicker from 'expo-image-picker';\nexport default function ImagePickerExample() {\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      image = _useState2[0],\n      setImage = _useState2[1];\n\n  useEffect(function () {\n    (function _callee() {\n      var _await$ImagePicker$re, status;\n\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!(Platform.OS !== 'web')) {\n                _context.next = 6;\n                break;\n              }\n\n              _context.next = 3;\n              return _regeneratorRuntime.awrap(ImagePicker.requestMediaLibraryPermissionsAsync());\n\n            case 3:\n              _await$ImagePicker$re = _context.sent;\n              status = _await$ImagePicker$re.status;\n\n              if (status !== 'granted') {\n                alert('Sorry, we need camera roll permissions to make this work!');\n              }\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    })();\n  }, []);\n\n  var pickImage = function pickImage() {\n    var result, localUri, filename, match, type, uploadData;\n    return _regeneratorRuntime.async(function pickImage$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return _regeneratorRuntime.awrap(ImagePicker.launchImageLibraryAsync({\n              mediaTypes: ImagePicker.MediaTypeOptions.All,\n              allowsEditing: true,\n              aspect: [4, 3],\n              quality: 1,\n              base64: true\n            }));\n\n          case 2:\n            result = _context2.sent;\n\n            if (!result.cancelled) {\n              localUri = result.uri;\n              filename = localUri.split('/').pop();\n              match = /\\.(\\w+)$/.exec(filename);\n              type = match ? \"image/\" + match[1] : \"image\";\n              console.log('type:', type);\n              uploadData = new FormData();\n              uploadData.append('title', 'lan2');\n              uploadData.append('cover', {\n                uri: localUri,\n                name: filename,\n                type: type\n              });\n              fetch('http://127.0.0.1:8000/books/', {\n                method: 'POST',\n                body: uploadData\n              }).then(function (res) {\n                return console.log('res:', res);\n              }).catch(function (error) {\n                return console.log(error);\n              });\n            }\n\n          case 4:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  return React.createElement(View, {\n    style: {\n      flex: 1,\n      alignItems: 'center',\n      justifyContent: 'center'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 5\n    }\n  }, React.createElement(Button, {\n    title: \"Pick an image from camera roll\",\n    onPress: pickImage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }\n  }), image && React.createElement(Image, {\n    source: {\n      uri: image\n    },\n    style: {\n      width: 200,\n      height: 200\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 17\n    }\n  }));\n}\n;","map":{"version":3,"sources":["C:/Users/HNC/Desktop/YT-image-upload/front-end/App.js"],"names":["React","useState","useEffect","ImagePicker","ImagePickerExample","image","setImage","Platform","OS","requestMediaLibraryPermissionsAsync","status","alert","pickImage","launchImageLibraryAsync","mediaTypes","MediaTypeOptions","All","allowsEditing","aspect","quality","base64","result","cancelled","localUri","uri","filename","split","pop","match","exec","type","console","log","uploadData","FormData","append","name","fetch","method","body","then","res","catch","error","flex","alignItems","justifyContent","width","height"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Button, Image, View, Platform, TextInput  } from 'react-native';\nimport * as ImagePicker from 'expo-image-picker';\n\nexport default function ImagePickerExample() {\n//////////////////////////////////\n    // const [ title, setTitle ] = useState(\"\");\n    // const [ cover, setCever ] = useState();\n    // //const [text, onChangeText] = React.useState(\"Useless Text\");\n\n    // const newBook = () => {\n    //     const uploadData = new FormData();\n    //     uploadData.append('title', title);\n    //     uploadData.append('cover', cover);\n    //     console.log('cover', cover);\n    //     fetch('http://127.0.0.1:8000/books/', {\n    //     method: 'POST',\n    //     body: uploadData\n    //     })\n    //     .then( res => console.log('res:', res))\n    //     .catch(error => console.log(error))\n        \n    // }\n//////////////////////////////////////\n    const [image, setImage] = useState(null);\n\n    useEffect(() => {\n        (async () => {\n        if (Platform.OS !== 'web') {\n            const { status } = await ImagePicker.requestMediaLibraryPermissionsAsync();\n            if (status !== 'granted') {\n            alert('Sorry, we need camera roll permissions to make this work!');\n            }\n        }\n        })();\n    }, []);\n\n    const pickImage = async () => {\n        var result = await ImagePicker.launchImageLibraryAsync({\n        mediaTypes: ImagePicker.MediaTypeOptions.All,\n        allowsEditing: true,\n        aspect: [4, 3],\n        quality: 1,\n        base64: true,\n        });\n\n        \n        if (!result.cancelled) {\n            // console.log('result.url', result.uri);\n            // setImage(result.uri);\n\n            // setTitle('xxx');\n            // setCever(result.uri);\n            // newBook();\n        \n            let localUri = result.uri;\n            let filename = localUri.split('/').pop();\n            // Infer the type of the image\n            let match = /\\.(\\w+)$/.exec(filename);\n            let type = match ? `image/${match[1]}` : `image`;\n              \n            console.log('type:', type);\n\n            const uploadData = new FormData();\n            uploadData.append('title', 'lan2');\n            \n            //uploadData.append('cover', result.uri);\n            uploadData.append('cover', { uri: localUri, name: filename, type });\n\n            fetch('http://127.0.0.1:8000/books/', {\n            method: 'POST',\n            body: uploadData\n            })\n            .then( res => console.log('res:', res))\n            .catch(error => console.log(error))\n        \n        }\n            \n            //console.log('helllo:', result);\n        };\n        \n\n\n  return (\n    <View style={{ flex: 1, alignItems: 'center', justifyContent: 'center' }}>  \n        {/* <TextInput\n        onChangeText={(evt) => setTitle(evt.target.value)}\n        value={title}\n        /> */}\n      <Button title=\"Pick an image from camera roll\" onPress={pickImage} />\n      {image && <Image source={{ uri: image }} style={{ width: 200, height: 200 }} />}\n    </View>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}